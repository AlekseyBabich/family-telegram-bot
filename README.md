# Family Telegram Bot

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–ë–æ—Ç Telegram —Å WebApp-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –¥–ª—è —Å–µ–º—å–∏: —Å–ø–∏—Å–∫–∏ –ø–æ–∫—É–ø–æ–∫, –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π –∏ —É—á—ë—Ç –±—é–¥–∂–µ—Ç–∞. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ Firebase Hosting, –∞ —Ñ—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ Firebase Functions.

## –°—Ç–µ–∫
- [Telegraf](https://telegraf.js.org/) –¥–ª—è –ª–æ–≥–∏–∫–∏ Telegram-–±–æ—Ç–∞.
- [Firebase Functions](https://firebase.google.com/docs/functions) –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏.
- [React](https://react.dev/) + [Vite](https://vitejs.dev/) –¥–ª—è WebApp.
- [Cloud Firestore](https://firebase.google.com/docs/firestore) –∫–∞–∫ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Windows 11)
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã Firebase CLI:
   ```powershell
   npm install -g firebase-tools
   ```
2. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:
   ```powershell
   firebase login
   firebase use family-bot-33940
   ```
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
   ```powershell
   npm -ws install
   ```
4. –ó–∞–¥–∞–π—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π (—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Firebase, –∞ –Ω–µ –≤ `.env`):
   ```powershell
   firebase functions:secrets:set BOT_TOKEN
   firebase functions:secrets:set BOT_USERNAME
   firebase functions:secrets:set FAMILY_CHAT_ID
   firebase functions:secrets:set NOTIFY_API_KEY
   ```
   –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤–≤–æ–¥ –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—á–∞ –∑–Ω–∞—á–µ–Ω–∏–π —á–µ—Ä–µ–∑ `--data`.

## –î–µ–ø–ª–æ–π
- **–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** –¥–≤–∞–∂–¥—ã –∫–ª–∏–∫–Ω–∏—Ç–µ `scripts/deploy_web.cmd` –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—Ä—É—á–Ω—É—é
  ```powershell
  npm run build:web
  npm run deploy:web
  ```
- **–§—É–Ω–∫—Ü–∏–∏:** –∑–∞–ø—É—Å—Ç–∏—Ç–µ `scripts/deploy_functions.cmd` –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—Ä—É—á–Ω—É—é
  ```powershell
  npm run build:functions
  npm run deploy:functions
  ```
- **–û–±–µ —á–∞—Å—Ç–∏ —Å—Ä–∞–∑—É:**
  ```powershell
  npm run deploy:all
  ```

## CI/CD –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–°–µ–∫—Ä–µ—Ç—ã:** GitHub Action –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–∫—Ä–µ—Ç `FIREBASE_SERVICE_ACCOUNT` —Å JSON —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ Firebase –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ `family-bot-33940`.
- **–¢—Ä–∏–≥–≥–µ—Ä—ã:**
  - pull request (opened/synchronize/reopened) ‚Üí —Å–±–æ—Ä–∫–∞ `apps/web` –∏ –≤—ã–∫–ª–∞–¥–∫–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π preview-–∫–∞–Ω–∞–ª Firebase Hosting —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º –≤ PR.
  - push –≤ `main` (–ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ `apps/web/**`, –∫–æ—Ä–Ω–µ–≤—ã—Ö `package.json`/`package-lock.json`, `firebase.json` –∏ —Å–∞–º–æ–º workflow) ‚Üí —Å–±–æ—Ä–∫–∞ `apps/web` –∏ –¥–µ–ø–ª–æ–π –Ω–∞ `family-bot-33940.web.app`.
- **–ö–∞–∫ –æ—Ç–∫–ª—é—á–∏—Ç—å –∏–ª–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å:**
  - –ß—Ç–æ–±—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–µ–≤—å—é, –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–ª–∏ —É–¥–∞–ª–∏—Ç–µ –±–ª–æ–∫ `pull_request` –≤ `.github/workflows/web-preview.yml`.
  - –ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å, –∫–∞–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø—É—Å–∫–∞—é—Ç –ø—Ä–æ–¥-–≤—ã–∫–ª–∞–¥–∫—É, –æ–±–Ω–æ–≤–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –ø—É—Ç–µ–π –≤ —Å–µ–∫—Ü–∏–∏ `on.push.paths` —Ñ–∞–π–ª–∞ `.github/workflows/web-prod.yml`.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–µ–±—Ö—É–∫–∞ Telegram
–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–µ–±—Ö—É–∫ —á–µ—Ä–µ–∑ BotFather (`/setwebhook`) –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –∑–∞–ø—Ä–æ—Å–æ–º –≤–∏–¥–∞:
```
https://api.telegram.org/bot<–í–ê–®_BOT_TOKEN>/setWebhook?url=https://<firebase-region>-<project>.cloudfunctions.net/telegramBot
```
–ó–∞–º–µ–Ω–∏—Ç–µ `<firebase-region>` –Ω–∞ —Ä–µ–≥–∏–æ–Ω —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π –∏ `<project>` –Ω–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `family-bot-33940`).

## –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å —Ç—É–Ω–Ω–µ–ª–µ–º
–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π HTTPS-—Ç—É–Ω–Ω–µ–ª—å –Ω–∞ Express-—Å–µ—Ä–≤–µ—Ä –±–æ—Ç–∞. –ü—Ä–æ–¥–∞–∫—à–Ω-–≤–µ–±—Ö—É–∫ –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º –Ω–∞ Firebase Functions (—Å–º. —Ä–∞–∑–¥–µ–ª –≤—ã—à–µ).

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env.local` –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ö–æ—Ç—è –±—ã `BOT_TOKEN` (–æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞).
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ª—é–±–æ–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç—É–Ω–Ω–µ–ª—å: [ngrok](https://ngrok.com/download) (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ) –∏–ª–∏ [cloudflared](https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/installation/).
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç `scripts/dev_local_start.cmd`. –û–Ω –ø–æ–¥–Ω–∏–º–µ—Ç `npm --workspace apps/bot run start`, –Ω–∞–π–¥—ë—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–π —Ç—É–Ω–Ω–µ–ª—å –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑–æ–≤–µ—Ç `setWebhook` –Ω–∞ –∞–¥—Ä–µ—Å –≤–∏–¥–∞ `<—Ç—É–Ω–Ω–µ–ª—å>/telegram/webhook`.
4. –°–∫—Ä–∏–ø—Ç –Ω–∞–ø–µ—á–∞—Ç–∞–µ—Ç —Ç–µ–∫—É—â–∏–π URL –∏–∑ `getWebhookInfo` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏. –ê–¥—Ä–µ—Å —Ç—É–Ω–Ω–µ–ª—è –º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ, –ø–æ—ç—Ç–æ–º—É –≤–µ–±—Ö—É–∫ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
5. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `scripts/dev_local_stop.cmd`. –û–Ω –æ—á–∏—Å—Ç–∏—Ç –≤–µ–±—Ö—É–∫ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã —Ç—É–Ω–Ω–µ–ª—è –∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –±–æ—Ç–∞.

> ‚ö†Ô∏è –ï—Å–ª–∏ –Ω–∏ –æ–¥–∏–Ω —Ç—É–Ω–Ω–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–∫—Ä–∏–ø—Ç –ø–æ–¥—Å–∫–∞–∂–µ—Ç, –∫–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ngrok –∏–ª–∏ cloudflared.

## –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã `firebase-tools`: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥—ã `firebase --version`.
- –ü—Ä–æ–µ–∫—Ç Firebase –Ω–µ –≤—ã–±—Ä–∞–Ω: –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `firebase use family-bot-33940`.
- –°–µ–∫—Ä–µ—Ç—ã –Ω–µ –∑–∞–¥–∞–Ω—ã: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —á–µ—Ç—ã—Ä–µ —Å–µ–∫—Ä–µ—Ç–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ Firebase Functions.
- –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Node.js 18+: –æ–±–Ω–æ–≤–∏—Ç–µ Node –¥–æ LTS.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WebApp URL –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –±–æ—Ç–∞
- –î–æ–±–∞–≤–ª–µ–Ω –µ–¥–∏–Ω—ã–π WebApp-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –ó–∞–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `WEBAPP_URL` c–æ —Å—Å—ã–ª–∫–æ–π –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω- –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π WebApp:
  - –õ–æ–∫–∞–ª—å–Ω–æ ‚Äî —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
  - –í –æ–±–ª–∞–∫–µ ‚Äî –∫–æ–º–∞–Ω–¥–æ–π `firebase functions:secrets:set WEBAPP_URL --data "https://example.com"`.
- –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞:
  1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –≤ Telegram ‚Äî –±–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å –æ–¥–Ω–æ–π —Ñ—Ä–∞–∑–æ–π ¬´Hello! Open the app:¬ª –∏ –∫–Ω–æ–ø–∫–æ–π ¬´Open the app¬ª.
  2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–¥ –ø–æ–ª–µ–º –≤–≤–æ–¥–∞ –Ω–µ –æ—Å—Ç–∞–ª–æ—Å—å —Å—Ç–∞—Ä—ã—Ö Reply-–∫–ª–∞–≤–∏–∞—Ç—É—Ä.
  3. –û—Ç–∫—Ä–æ–π—Ç–µ –º–µ–Ω—é (‚â°) –≤ —á–∞—Ç–µ ‚Äî —Ç–∞–º –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –∫–Ω–æ–ø–∫–∞ WebApp —Å —Ç–µ–º –∂–µ URL.

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `apps/bot/src/index.ts`
- `apps/bot/src/menu.ts`
- `apps/bot/src/types.d.ts`
- `firebase/functions.ts`
- `.env.example`

## –ö–∞–∫ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ CI/CD
–î–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –¥–µ–ø–ª–æ—è–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–æ–≤–∞ –≤–∫–ª—é—á–∏—Ç—å –±–∏–ª–ª–∏–Ω–≥ –≤ Firebase –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å GitHub Actions workflows (`.github/workflows`). –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–æ–∫–µ–Ω—ã –∏ —Å–µ–∫—Ä–µ—Ç—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å-–∞–∫–∫–∞—É–Ω—Ç–∞, —á—Ç–æ–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞–π–ø–ª–∞–π–Ω—ã —Å–Ω–æ–≤–∞ –∑–∞–ø—É—Å–∫–∞–ª–∏—Å—å –ø—Ä–∏ –ø—É—à–∞—Ö –≤ –æ—Å–Ω–æ–≤–Ω—É—é –≤–µ—Ç–∫—É.

## WebApp (apps/web)
–í–µ–±-–∫–ª–∏–µ–Ω—Ç –ø–æ–¥–∫–ª—é—á—ë–Ω –∫ Cloud Firestore: –≤–∫–ª–∞–¥–∫–∞ ¬´–ü–æ–∫—É–ø–∫–∏¬ª —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏ `/families/dev-family/lists/{listId}/items/{itemId}`. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Å—Ç–∞—ë—Ç—Å—è –º–æ–±–∏–ª—å–Ω—ã–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–≤–∞–π–ø—ã, —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫, —Ä–∞–∑–¥–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ –æ—Ç–º–µ—á–µ–Ω–Ω—ã—Ö –∏ –Ω–µ–æ—Ç–º–µ—á–µ–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π –∏ –∫–Ω–æ–ø–∫—É ¬´+ –¥–æ–±–∞–≤–∏—Ç—å¬ª –≤ –∫–æ–Ω—Ü–µ —Å–ø–∏—Å–∫–∞.

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ `apps/web/.env.local` (–∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã Vite) —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ Firebase:

```
VITE_FB_API_KEY=
VITE_FB_AUTH_DOMAIN=
VITE_FB_PROJECT_ID=
VITE_FB_STORAGE_BUCKET=
VITE_FB_MESSAGING_SENDER_ID=
VITE_FB_APP_ID=
VITE_FB_EMULATOR_HOST=127.0.0.1 # optional: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Firestore Emulator
VITE_FB_EMULATOR_PORT=8080      # optional: –ø–æ—Ä—Ç Firestore Emulator
```

–í —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è idempotent-–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ `dev-family` –∏ —Å–ø–∏—Å–∫–æ–≤ `food`/`household`/`stuff`. –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ IndexedDB SDK –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫–∞—Ç–∏—Ç—Å—è –∫ –æ–Ω–ª–∞–π–Ω-—Ä–µ–∂–∏–º—É –±–µ–∑ –æ—Ñ–ª–∞–π–Ω-–∫—ç—à–∞.

> üîß –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —ç–º—É–ª—è—Ç–æ—Ä–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `VITE_FB_EMULATOR_HOST`/`VITE_FB_EMULATOR_PORT` —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ `firebase emulators:start`. –ö–ª–∏–µ–Ω—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —ç–º—É–ª—è—Ç–æ—Ä—É –¥–æ –ø–µ—Ä–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ –ø–æ—Å–ª–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–π –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–æ–∫.

–î–ª—è –∑–∞–ø—Ä–æ—Å–∞ `where('checked', '==', ...)` –≤–º–µ—Å—Ç–µ —Å `orderBy('titleLower')` –Ω—É–∂–µ–Ω –∫–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –∏–Ω–¥–µ–∫—Å. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ `firebase/firestore.indexes.json`.

### Firestore –ø—Ä–∞–≤–∏–ª–∞
`firebase/firestore.rules` –≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å —Ç–æ–ª—å–∫–æ –≤ `families/dev-family/**`, —á—Ç–æ–±—ã –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º—É –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

### –¢–µ—Å—Ç—ã
`npm --workspace apps/web run test` –∑–∞–ø—É—Å–∫–∞–µ—Ç Vitest. –ü–æ–∫—Ä—ã—Ç–∏–µ –≤–∫–ª—é—á–∞–µ—Ç:
- –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ snapshot-–¥–∞–Ω–Ω—ã—Ö Firestore –≤ –¥–≤–µ —Å–µ–∫—Ü–∏–∏ —á–µ–∫–ª–∏—Å—Ç–∞;
- –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ `addItem`/`toggleChecked`/`removeItem` –Ω–∞ in-memory —ç–º—É–ª—è—Ü–∏–∏ API (–±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π);
- UI-—Ç–µ—Å—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã ¬´–ü–æ–∫—É–ø–∫–∏¬ª —Å –º–æ–∫–∞–º–∏ realtime-–ø–æ—Ç–æ–∫–æ–≤.

### –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- `npm --workspace apps/web run dev` ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (Vite –Ω–∞ `http://localhost:5173`).
- `npm --workspace apps/web run build` ‚Äî production-—Å–±–æ—Ä–∫–∞.
- `npm --workspace apps/web run preview` ‚Äî –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä production-—Å–±–æ—Ä–∫–∏.
- `npm --workspace apps/web run test` ‚Äî –ø—Ä–æ–≥–æ–Ω–∏—Ç vitest –∏ smoke-—Ç–µ—Å—Ç—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤.

### Gesture notes (apps/web)
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∫—É–ø–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `useSwipeable` —Å –æ–ø—Ü–∏—è–º–∏ `preventScrollOnSwipe: true`, `trackMouse: true` –∏ `delta: 12`, —á—Ç–æ–±—ã –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø–ª–∞–≤–Ω—ã–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ —Å–≤–∞–π–ø—ã –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª —Å–ø–∏—Å–∫–æ–≤.
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä `.mobileContent` –ø–æ–ª—É—á–∞–µ—Ç `touch-action: pan-y`, –ø–æ—ç—Ç–æ–º—É –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ –∂–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤–Ω—É—Ç—Ä–∏ —á–µ–∫–ª–∏—Å—Ç–æ–≤, –∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Å–≤–∞–π–ø–µ—Ä—É.
- –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∂–µ—Å—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `npm --workspace apps/web run test` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω—ã unit-—Ç–µ—Å—Ç—ã, –º–æ–¥–µ–ª–∏—Ä—É—é—â–∏–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–µ —Å–≤–∞–π–ø—ã, –∞ —Ç–∞–∫–∂–µ –∫–ª–∏–∫–∏ –∏ —Ä–∞–±–æ—Ç—É –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–∞—Ö.

### –ú–∞—Ä—à—Ä—É—Ç—ã
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `HashRouter` –∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å –≤–∫–ª–∞–¥–∫–∏ ¬´–ü–æ–∫—É–ø–∫–∏¬ª.
- `#/shopping` ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–ü–æ–∫—É–ø–∫–∏¬ª —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∑–∞–≥–æ–ª–æ–≤–∫–æ–º ¬´–ü–æ–∫—É–ø–∫–∏¬ª –ø–æ —Ü–µ–Ω—Ç—Ä—É.
- `#/calendar` ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–ö–∞–ª–µ–Ω–¥–∞—Ä—å¬ª —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º ¬´–ö–∞–ª–µ–Ω–¥–∞—Ä—å¬ª.
- `#/budget` ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ ¬´–ë—é–¥–∂–µ—Ç¬ª —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º ¬´–ë—é–¥–∂–µ—Ç¬ª.

–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –≤–µ—Ä—Ö–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ç–∞–±—ã, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã (–±–µ–∑ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –∏ —Å –∫—Ä—É–ø–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏).
